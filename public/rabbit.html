<!DOCTYPE html>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Meta Rabbit Wallet - Ativos</title>
<link rel="icon" href="logo.png">
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

  * { box-sizing: border-box; }

  body {
    margin: 0;
    padding: 0;
    background: #121212;
    color: #e5e5e5;
    font-family: 'Roboto', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }

  /* ===================== */
  /* HEADER */
  /* ===================== */
  header {
    padding: 24px 0 12px;
    text-align: center;
  }

  header h1 {
    font-size: 2rem;
    color: #1db954; /* Verde Spotify */
    margin: 0;
    font-weight: 700;
  }

  /* ===================== */
  /* BALANCE */
  /* ===================== */
  #balance-box {
    width: 92%;
    max-width: 540px;
    background: #181818;
    color: #1db954;
    padding: 26px;
    border-radius: 14px;
    text-align: center;
    margin: 20px 0;
    font-size: 1.5rem;
    font-weight: bold;
    box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);
  }

  /* ===================== */
  /* ACTION BUTTONS */
  /* ===================== */
  .actions {
    display: flex;
    gap: 12px;
    justify-content: center;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }

  .btn {
    flex: 1;
    min-width: 120px;
    background: #1db954;
    color: #fff;
    border: none;
    border-radius: 28px;
    padding: 12px;
    font-weight: bold;
    font-size: 0.95rem;
    cursor: pointer;
    transition: all 0.25s ease;
  }

  .btn:hover {
    background: #17a74a;
    transform: scale(1.03);
  }

  /* ===================== */
  /* TRANSACTION LIST */
  /* ===================== */
  .transactions {
    width: 92%;
    max-width: 540px;
    background: #181818;
    border-radius: 12px;
    padding: 18px;
    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.6);
    margin-bottom: 28px;
  }

  .transactions h2 {
    font-size: 1.1rem;
    color: #ccc;
    margin-bottom: 14px;
    font-weight: 500;
  }

  .transaction {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid #222;
    font-size: 0.95rem;
  }

  .transaction:last-child {
    border-bottom: none;
  }

  .transaction span.amount {
    font-weight: bold;
    color: #1db954;
  }

  .transaction span.out {
    color: #e91429;
  }

  /* ===================== */
  /* FOOTER */
  /* ===================== */
  footer {
    margin-top: auto;
    padding: 18px;
    color: #777;
    font-size: 0.85rem;
    text-align: center;
    border-top: 1px solid #222;
  }

  /* ===================== */
  /* RESPONSIVIDADE */
  /* ===================== */
  @media (max-width: 600px) {
    header h1 {
      font-size: 1.6rem;
    }
    #balance-box {
      font-size: 1.2rem;
      padding: 20px;
    }
    .btn {
      font-size: 0.9rem;
      padding: 10px;
    }
    .transactions {
      padding: 14px;
    }
  }
</style>

</head>
<body>

<form class="wallet" onsubmit="return false;">
  <div class="header">
    <h1>Meta Rabbit</h1>
    <img src="t.png" alt="Meta Rabbit Logo">
  </div>

  <div id="balance-box">Saldo: $0,00</div>

  <div class="input-box">
    <label for="assetSelect">Selecione seu ativo:</label>
    <select id="assetSelect">
      <option value="">Selecione um ativo</option>
      <option value="zobtc_starter50">Z-OBTC ‚Äî $10 - $40 (Starter50 Œ£)</option>
      <option value="zobtc_growth500">Z-OBTC ‚Äî $100 - $200 (Growth500 Œ£)</option>
      <option value="zobtc_pro1000">Z-OBTC ‚Äî $200 - $400 (Pro1000 Œ£)</option>
      <option value="pynkbtc_starter">Pynk BTC ‚Äî $50 - $200 (Starter Œ£)</option>
      <option value="pynkbtc_growth">Pynk BTC ‚Äî $200 - $800 (Growth Œ£)</option>
      <option value="pynkbtc_pro">Pynk BTC ‚Äî $800 - $2,000 (Pro Œ£)</option>
  <option value="mini10">Mini10 ‚Äî R$10 - R$49 (c/ taxa 1%)</option>
  <option value="basic25">Basic25 ‚Äî R$25 - R$49 (c/ taxa 1%)</option>
  <option value="starter50">Starter50 ‚Äî R$50 - R$200 (c/ taxa 1%)</option>
  <option value="basic201">Basic201 ‚Äî R$201 - R$500 (c/ taxa 1%)</option>
  <option value="growth500">Growth500 ‚Äî R$501 - R$1.000 (c/ taxa 1%)</option>
  <option value="pro1000">Pro1000 ‚Äî R$1.001 - R$2.000 (c/ taxa 1%)</option>
  <option value="advanced2000">Advanced2000 ‚Äî R$2.001 - R$4.000 (c/ taxa 1%)</option>
  <option value="diamond500">Diamond500 ‚Äî R$5.000 - R$15.000 (c/ taxa 1%)</option>
  <option value="ultraenther">UltraEnther ‚Äî R$10.000 - R$30.000 (c/ taxa 1%)</option>
  <option value="qzdiamond">QZDiamond ‚Äî R$7.000 - R$20.000 (c/ taxa 1%)</option>
  <option value="entherprime">EntherPrime ‚Äî R$3.000 - R$9.000 (c/ taxa 1%)</option>
  <option value="jbx_br">JBX-BR ‚Äî R$1.000 - R$5.000 (c/ taxa 1%)</option>
  <option value="darkusd">DarkUSD ‚Äî R$2.000 - R$8.000 (c/ taxa 1%)</option>
  <option value="darkbtc">DarkBTC ‚Äî R$10.000 - R$50.000 (c/ taxa 1%)</option>
  <option value="trixusd">TrixUSD ‚Äî R$5.000 - R$25.000 (c/ taxa 1%)</option>
  <option value="jbx_diamond">JBX Diamond ‚Äî R$20.000 - R$60.000 (c/ taxa 1%)</option>
  <option value="zobtc_starter50">Z-OBTC ‚Äî $10 - $40 (Starter50 Œ£)</option>
  <option value="zobtc_growth500">Z-OBTC ‚Äî $100 - $200 (Growth500 Œ£)</option>
  <option value="zobtc_pro1000">Z-OBTC ‚Äî $200 - $400 (Pro1000 Œ£)</option>
  <option value="pynkbtc_starter">Pynk BTC ‚Äî $50 - $200 (Starter Œ£)</option>
  <option value="pynkbtc_growth">Pynk BTC ‚Äî $200 - $800 (Growth Œ£)</option>
  <option value="pynkbtc_pro">Pynk BTC ‚Äî $800 - $2,000 (Pro Œ£)</option>
</select>

  </div>

  <div class="input-box">
    <label for="valueInput">Valor por unidade (USD):</label>
    <input type="number" id="valueInput" placeholder="Digite o valor" min="1">
  </div>

  <div class="input-box">
    <label for="quantityInput">Quantidade de unidades:</label>
    <input type="number" id="quantityInput" placeholder="Digite a quantidade" min="1" value="1">
  </div>

  <button id="generateBtn" class="btn">Gerar QR Code</button>

  <div id="qrcode-stripe"></div>
  <div id="output"></div>
</form>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script>
(() => {
  const generateBtn = document.getElementById("generateBtn");
  const qrContainer = document.getElementById("qrcode-stripe");
  const output = document.getElementById("output");
  const balanceBox = document.getElementById("balance-box");
  const assetSelect = document.getElementById("assetSelect");
  const valueInput = document.getElementById("valueInput");
  const quantityInput = document.getElementById("quantityInput");

  let balance = 0;

  async function generateQR() {
    qrContainer.innerHTML = "";
    output.innerText = "";

    const value = parseFloat(valueInput.value);
    const quantity = parseInt(quantityInput.value) || 1;

    if (!value || value <= 0) return alert("‚ö†Ô∏è Valor inv√°lido.");
    if (quantity <= 0) return alert("‚ö†Ô∏è Quantidade inv√°lida.");
    if (!assetSelect.value) return alert("‚ö†Ô∏è Selecione um ativo.");

    try {
      const res = await fetch("/api/create-checkout-session", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ asset: assetSelect.value, value, quantity })
      });

      const data = await res.json();
      if (!res.ok) return alert(data.error || "Erro ao criar sess√£o Stripe.");

      // gerar QR Code
      QRCode.toCanvas(data.url, { 
        width: 220, 
        color: { dark: "#00ff66", light: "#1a1a1a" } 
      }, (err, canvas) => {
        if (err) return console.error(err);
        qrContainer.appendChild(canvas);
      });

      // c√°lculo com taxa de 1%
      const total = value * quantity;
      const fee = total * 0.01; // 1%
      const finalAmount = total - fee;

      balance += finalAmount; // Atualiza saldo com taxa descontada
      balanceBox.innerText = `Saldo: $${balance.toFixed(2)}`;

      output.innerText = `üì≤ QR Code Stripe gerado!
üí∞ Valor total: $${total.toFixed(2)}
üí∏ Taxa (1%): $${fee.toFixed(2)}
‚úÖ Valor l√≠quido: $${finalAmount.toFixed(2)}
üîÅ Ativo: ${assetSelect.value}
üÜî TXID: ${data.txid || 'N/A'}`;

    } catch (err) {
      console.error(err);
      alert("Erro de conex√£o com o servidor.");
    }
  }

  generateBtn.addEventListener("click", generateQR);
})();
</script>


<footer>Meta Rabbit ¬© 2025 BY @LUCASJANUARIO14 </footer>
</body>
</html>
